
# Temporarily set a build number format that includes a large revision
# number that won't conflict with buildpipeline official builds.
name: $(Date:yyyyMMdd)$(Rev:.7r)

jobs:
- job: testjob
  pool: Hosted MacOS
  steps:
  - script: pwd
  - script: echo $(Build.SourcesDirectory)
  - script: |
          mkdir $(Build.SourcesDirectory)/artifactDir
          echo hi > $(Build.SourcesDirectory)/artifactDir/test.txt
  - task: PublishPipelineArtifact@0
    inputs:
      artifactName: myartifact
      targetPath: $(Build.SourcesDirectory)/artifactDir
  - script: |
          rm $(Build.SourcesDirectory)/artifactDir/test.txt
          rmdir $(Build.SourcesDirectory)/artifactDir
  - script: ls $(Build.SourcesDirectory)
  - task: DownloadPipelineArtifact@0
    inputs:
      artifactName: myartifact
      targetPath: $(Build.SourcesDirectory)/artifactDir
  - script: |
          ls $(Build.SourcesDirectory)
          cat $(Build.SourcesDirectory)/artifactDir/test.txt
